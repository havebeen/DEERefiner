# Description
DEERefiner is a MATLAB GUI program for modeling protein ensemble using DEER data. 

This program allows biophysists to obtain DEER-derived protein structure.

![Alt text](primaryPage.png?raw=true "Primary page")

## Built With
MATLAB R2021a on macOS Monterey

# Getting Started

## Prerequisites

1. MATLAB R2021a or later
2. MATLAB Parallel Computing Toolbox (accelerate drastically)

## Installation
1. Clone the repository (or download the whole folder)
```Bash
# Download the DEERefiner folder
git clone https://github.com/havebeen/DEERefiner/
```
2. Set the DEERefiner folder to your MATLAB path

## Usage
```MATLAB
% Launch DEERefiner GUI in MATLAB
DEERefiner
```
### Step 1- Loading PDB file

DEERefiner supports almost all PDB files from different resources, including NMR, Cryo-EM, crystallography, and AlphaFold.

Note that, DEERefiner utilizes the first conformation While using NMR structre as the input.

DEERefiner mutates residues with unresolved side chain to alanine.

https://user-images.githubusercontent.com/52059244/197706328-57467d3a-d5c8-4719-b288-6fb34c5f26c7.mov

### Step 2- Loading distance distribution files (supporting all ASCII file with distance in nm as first column and probability as second column)

DEERefiner supports all ASCII file with distance in nm as first column and probability as second column, such as files from DeerAnalysis or see `Example/YetJ/YetJ_10_184.dat`.

https://user-images.githubusercontent.com/52059244/197706607-dffce381-2bbf-4b6b-acd8-6867cef81ce7.mov

### Step 3- Reselect target distance (optional)

### Step 4- Removing wrongly-loaded distance distribution files (optional)

Users can use the feature to remove wrongly-loaded distance distribution.

https://user-images.githubusercontent.com/52059244/197720294-396bd9a5-2887-4b5f-bd41-5e1a31f89f16.mov

### Step 4- Setting parameters

All parameter will be determined after loading PDB file and all distance distribution files. 

However, the definition of each parameter are listed below in case users want to change them manually.

1. Flexible regions: Residue index with rotatable peptide bonds during simulation.
2. phi/psi angle: Peptide bonds rotating angle at each step.
3. MC iteration: Number of Monte Carlo steps.
4. MC temp.: denominator of the Boltzman factor exponent of Monte Carlo algorithm, larger the MC temp., more easily to escape local minimum.
5. RMSE: Root mean square error criterion for determining convergence, smaller the RMSE, harder to converge.
6. Maximal clashes: Clashed side chain criterion. Clashed residues should be minimized if further simulations will be performed.
7. Number of structure: Total structure will be generated by DEERefiner.
8. Usage of cores: Total CPU cores will be used during simulation.

### Step 5- Executing simulations
Option 1. Execute simulation with GUI
  Click the Start buttom.

https://user-images.githubusercontent.com/52059244/197730047-d7a84555-ab56-41e4-918c-7af96cab41ed.mov
  
Option 2. Execute simulation with command line
```MATLAB
% simulation execution in MATLAB
Job = runFilesCluterExecutor;
```

# License
Distributed under the MIT license. See`LICENSE.TXT` for more information.
